/*!
 * jquery.tree.struts2.js
 *
 * Integration of trees with struts 2
 *
 * Requires use of jquery.struts2.js
 *
 * Copyright (c) 2010 Johannes Geppert http://www.jgeppert.com
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 */
(function(a){a.struts2_jquery_tree={handler:{show_checkboxes:"_s2j_show_checkboxes",hide_checkboxes:"_s2j_hide_checkboxes",toggle_checkboxes:"_s2j_toggle_all"},tree:function(c,e){var b=this,d=null;if(!b.loadAtOnce){b.require("js/base/jquery.cookie"+b.minSuffix+".js")}b.require("js/jstree/jquery.hotkeys"+b.minSuffix+".js");b.require("js/jstree/jquery.jstree"+b.minSuffix+".js",function(){a.jstree.defaults.core.themes.url=true;a.jstree.defaults.core.themes.dir="struts/js/jstree/themes"});e.plugins=[];e.core={};if(e.treetheme){e.core.themes={};e.core.themes.name=e.treetheme;if(!a.scriptPath){d=""}else{d=a.scriptPath}e.core.themes.dots=e.dots;e.core.themes.icons=e.icons}else{e.plugins.push("themeroller")}if(e.contextmenu){e.core.check_callback=true;e.plugins.push("contextmenu")}if(e.types){e.plugins.push("types")}if(e.checkbox){e.plugins.push("checkbox");e.checkbox={override_ui:true,real_checkboxes:true,real_checkboxes_names:function(f){return[e.name,f.attr?f.attr("id"):0]}};if(e.two_state){e.checkbox.two_state=true}c.bind("loaded.jstree",function(f,g){c.find("li").each(function(h){if(a(this).data("checked")==true){c.jstree("check_node",a(this))}})})}if(e.toogleAllTopics){b.subscribeTopics(c,e.toogleAllTopics,b.handler.toggle_checkboxes,e)}if(e.checkShowTopics){b.subscribeTopics(c,e.checkShowTopics,b.handler.show_checkboxes,e)}if(e.checkHideTopics){b.subscribeTopics(c,e.checkHideTopics,b.handler.hide_checkboxes,e)}if(e.url){e.core.data={};e.core.data.url=e.url;e.core.data.data=function(f){return{operation:"get_children",id:f.id}};if(e.onsuc){e.json_data.ajax.complete=function(h,f,g){a.each(e.onsuc.split(","),function(k,j){var l={};l.data=h;l.status=f;l.request=g;b.publishTopic(c,j,l);b.publishTopic(c,e.onalw,l)})}}if(e.oncom){e.json_data.ajax.complete=function(g,f){a.each(e.oncom.split(","),function(h,j){var k={};k.request=g;k.status=f;b.publishTopic(c,j,k);b.publishTopic(c,e.onalw,k)})}}if(e.onerr){e.json_data.ajax.error=function(h,f,g){a.each(e.onerr.split(","),function(k,j){var l={};l.request=h;l.status=f;l.error=g;b.publishTopic(c,j,l);b.publishTopic(c,e.onalw,l)})}}}c.on("select_node.jstree",function(h,j){var i={};i.data=j;i.event=h;if(e.onclick){b.publishTopic(c,e.onclick,i)}if(j.node.a_attr.href&&j.node.a_attr.href!=="#"){window.location=j.node.a_attr.href}else{var k=j.node.a_attr.id,g=a(b.escId(k)),f=g.data("targets");if(f){a.each(f.split(","),function(l,m){g.publish("_sj_action_"+k+m);return false})}}});if(e.openload){c.bind("loaded.jstree",function(f,g){c.jstree("open_all")})}if(e.openrefresh){c.bind("refresh.jstree",function(f,g){c.jstree("open_all")})}if(e.animation){e.core={};e.core.animation=e.animation}c.jstree(e)},treeitem:function(c,d){var b=this;b.anchor(c,d)}};a.subscribeHandler(a.struts2_jquery_tree.handler.show_checkboxes,function(b,c){a(this).jstree("show_checkboxes")});a.subscribeHandler(a.struts2_jquery_tree.handler.hide_checkboxes,function(b,c){a(this).jstree("hide_checkboxes")});a.subscribeHandler(a.struts2_jquery_tree.handler.toggle_checkboxes,function(b,c){a(this).jstree("toggle_checkboxes")});a.extend(true,a.struts2_jquery_tree,a.struts2_jquery);a.struts2_jquery_tree.debugPrefix="[struts2_jquery_tree] "})(jQuery);