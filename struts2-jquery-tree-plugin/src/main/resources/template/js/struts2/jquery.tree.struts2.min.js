/*!
 * jquery.tree.struts2.js
 *
 * Integration of trees with struts 2
 *
 * Requires use of jquery.struts2.js
 *
 * Copyright (c) 2010 Johannes Geppert http://www.jgeppert.com
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 */
!function(e){"use strict";e.struts2_jquery_tree={handler:{show_checkboxes:"_s2j_show_checkboxes",hide_checkboxes:"_s2j_hide_checkboxes",check_checkboxes:"_s2j_check_checkboxes",uncheck_checkboxes:"_s2j_uncheck_checkboxes",toggle_checkboxes:"_s2j_toggle_all"},tree:function(c,s){var t=this,r=null;t.loadAtOnce||t.require("js/base/jquery.cookie"+t.minSuffix+".js"),t.require("js/jstree/jquery.hotkeys"+t.minSuffix+".js"),t.require("js/jstree/jquery.jstree"+t.minSuffix+".js",function(){e.jstree.defaults.core.themes.url=!0,e.jstree.defaults.core.themes.dir="struts/js/jstree/themes"}),s.plugins=[],s.core={},s.treetheme?(s.core.themes={},s.core.themes.name=s.treetheme,r=e.scriptPath?e.scriptPath:"",s.core.themes.dots=s.dots,s.core.themes.icons=s.icons):s.plugins.push("themeroller"),s.contextmenu&&(s.core.check_callback=!0,s.plugins.push("contextmenu")),s.types&&s.plugins.push("types"),s.checkbox&&(s.plugins.push("checkbox"),s.checkbox={override_ui:!0,real_checkboxes:!0,real_checkboxes_names:function(e){return[s.name,e.attr?e.attr("id"):0]}},s.two_state&&(s.checkbox.two_state=!0),c.bind("loaded.jstree",function(){c.find("li").each(function(){1==e(this).data("checked")&&c.jstree("check_node",e(this))})}),c.on("changed.jstree",function(){e(t.escId(s.id+"_hidden")).val(c.jstree("get_checked",!1))}),e(t.escId(s.id+"_hidden")).val(c.jstree("get_checked",!1))),s.toogleAllTopics&&t.subscribeTopics(c,s.toogleAllTopics,t.handler.toggle_checkboxes,s),s.checkShowTopics&&t.subscribeTopics(c,s.checkShowTopics,t.handler.show_checkboxes,s),s.checkHideTopics&&t.subscribeTopics(c,s.checkHideTopics,t.handler.hide_checkboxes,s),s.checkAllTopics&&t.subscribeTopics(c,s.checkAllTopics,t.handler.check_checkboxes,s),s.uncheckAllTopics&&t.subscribeTopics(c,s.uncheckAllTopics,t.handler.uncheck_checkboxes,s),s.url&&(s.core.data={},s.core.data.url=s.url,s.core.data.data=function(e){return{id:e.id}},s.onsuc&&(s.json_data.ajax.complete=function(r,o,n){e.each(s.onsuc.split(","),function(e,i){var h={};h.data=r,h.status=o,h.request=n,t.publishTopic(c,i,h),t.publishTopic(c,s.onalw,h)})}),s.oncom&&(s.json_data.ajax.complete=function(r,o){e.each(s.oncom.split(","),function(e,n){var i={};i.request=r,i.status=o,t.publishTopic(c,n,i),t.publishTopic(c,s.onalw,i)})}),s.onerr&&(s.json_data.ajax.error=function(r,o,n){e.each(s.onerr.split(","),function(e,i){var h={};h.request=r,h.status=o,h.error=n,t.publishTopic(c,i,h),t.publishTopic(c,s.onalw,h)})})),c.on("select_node.jstree",function(r,o){var n={};if(n.data=o,n.event=r,s.onclick&&t.publishTopic(c,s.onclick,n),o.node.a_attr.href&&"javascript:void(0)"!==o.node.a_attr.href)window.open(o.node.a_attr.href,"_blank");else{var i=o.node.a_attr.id,h=e(t.escId(i)),u=h.data("targets");u&&e.each(u.split(","),function(e,c){return h.publish("_sj_action_"+i+c),!1})}}),s.openload&&c.bind("loaded.jstree",function(){c.jstree("open_all")}),s.openrefresh&&c.bind("refresh.jstree",function(){c.jstree("open_all")}),s.animation&&(s.core={},s.core.animation=s.animation),c.jstree(s)},treeitem:function(e,c){var s=this;s.anchor(e,c)}},e.subscribeHandler(e.struts2_jquery_tree.handler.show_checkboxes,function(){e(this).jstree("show_checkboxes")}),e.subscribeHandler(e.struts2_jquery_tree.handler.hide_checkboxes,function(){e(this).jstree("hide_checkboxes")}),e.subscribeHandler(e.struts2_jquery_tree.handler.toggle_checkboxes,function(){e(this).jstree("toggle_checkboxes")}),e.subscribeHandler(e.struts2_jquery_tree.handler.check_checkboxes,function(){e(this).jstree("check_all")}),e.subscribeHandler(e.struts2_jquery_tree.handler.uncheck_checkboxes,function(){e(this).jstree("uncheck_all")}),e.extend(!0,e.struts2_jquery_tree,e.struts2_jquery),e.struts2_jquery_tree.debugPrefix="[struts2_jquery_tree] "}(jQuery);